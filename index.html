
<!doctype html>
<html>
<head>
<meta charset="utf-8">
<title>Quiz - static (load JSON)</title>
<style>
body{font-family: Arial, sans-serif; padding:20px; max-width:1000px; margin:auto}
.cq{border:1px solid #ddd; padding:12px; margin:8px 0; border-radius:6px}
.option{display:flex; align-items:center; gap:8px; margin:6px 0}
.optbtn{cursor:pointer; padding:6px 10px; border-radius:4px; border:1px solid #ccc; background:#f9f9f9}
.optbtn.correct{background:gold}
.special{border-color:#f88; background:#fff5f5}
.controls{margin:12px 0; display:flex; gap:8px}
</style>
</head>
<body>
<h1>Quiz (static) — parsed from luật.pdf</h1>
<div class="controls">
<button id="saveBtn">Export annotations JSON</button>
<span id="stats"></span>
</div>
<div id="container">Đang tải dữ liệu...</div>

<script>
let questions = [];
function render(){
  const container = document.getElementById('container');
  container.innerHTML = '';
  questions.forEach((q, idx) => {
    const div = document.createElement('div');
    div.className = 'cq' + (q.special ? ' special' : '');
    const qh = document.createElement('div');
    qh.innerHTML = '<strong>Câu ' + q.id + '.</strong> ' + q.text;
    div.appendChild(qh);
    q.options.forEach(opt => {
      const op = document.createElement('div'); op.className='option';
      const b = document.createElement('button'); b.className='optbtn'; b.textContent=opt.id;
      if (q.correct === opt.id) b.classList.add('correct');
      b.onclick = ()=>{ 
        q.correct = (q.correct===opt.id)? null : opt.id; 
        render(); 
      };
      const span = document.createElement('div'); span.textContent = opt.text;
      op.appendChild(b); op.appendChild(span);
      div.appendChild(op);
    });
    const spec = document.createElement('button'); spec.textContent = q.special ? 'Unmark special' : 'Mark special';
    spec.onclick = ()=>{ q.special = !q.special; render();};
    div.appendChild(spec);
    container.appendChild(div);
  });
  const stats = document.getElementById('stats');
  const answered = questions.filter(q=>q.correct).length;
  stats.textContent = answered + '/' + questions.length + ' answered';
}

document.getElementById('saveBtn').onclick = ()=>{
  const dataStr = JSON.stringify(questions, null, 2);
  const blob = new Blob([dataStr], {type:'application/json'});
  const url = URL.createObjectURL(blob);
  const a = document.createElement('a'); a.href=url; a.download='annotations.json'; a.click();
  URL.revokeObjectURL(url);
};

fetch('parsed_questions.json')
  .then(r=>r.json())
  .then(data=>{questions=data; render();})
  .catch(e=>{document.getElementById('container').textContent='Không đọc được parsed_questions.json';});
</script>
</body>
</html>
